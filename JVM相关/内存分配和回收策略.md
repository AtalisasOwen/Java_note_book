# 内存分配和回收策略

## ![](/assets/16150211_aRgY.jpg)

* ### Young中存放新生的对象（Eden:Survivor = 8:1）
* ### Old中存放生命周期长的对象
* ### Permanent中存放永久保存的，如Class和Meta信息

## 1.分代GC

* ### 频繁收集Young
* ### 较少收集Old
* ### 基本不收集Perm
* ### Minor GC\(收集Young区域\)后，会将存活对象移到Survivor区，对象过大则放到Old，所以Eden会为空
* ### Full GC/Major GC:发生在老生代的GC,速度比Minor GC慢10倍以上

## 2.对象分配

* ### 对象优先在Eden分配，当Eden空间不足，将会发起一次Minor GC。收集垃圾，并转移对象。
* ### 大对象直接进入老年代，（避免短命的大对象）经常出现大对象会导致内存还有空间就提前触发GC
* ### 长期存活的对象将进入老年代：虚拟机给每个对象设定一个Age计数器，每熬过一次Minor GC就Age加1。默认到15岁，会被移入老年代
* ### 动态对象年龄判定: 当Survivor空间中相同年龄的对象内存总和达到一半，年龄大于等于该年龄的对象可以直接进入老年代。不必达到规定年龄
* ### 空间分配担保：发生GC前，虚拟机会检查老年代最大可用的连续空间是否大于新生代所有对象总空间。如果成立，会进行Minor GC，否则查看是否有担保。



