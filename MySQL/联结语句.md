# 联结语句和子查询

## \*交叉联结

### **toys表**

| toy\_id | toy |
| :---: | :---: |
| 1 | hula hoop |
| 2 | balsa glider |
| 3 | toy soldiers |
| 4 | harmonica |
| 5 | baseball cards |

### boys表

| boy\_id | boy |
| :---: | :---: |
| 1 | Davey |
| 2 | Bobby |
| 3 | Beaver |
| 4 | Richie |

```
//交叉联结 ---> 组合
SELECT t.toy, b.boy
FROM toys AS t
    CROSS JOIN
    boys AS b;
```

---

## \*内联结与自然联结

| _**my\_contacts**_ | contact\_id\(主键\) | name | phone | email | prof\_id\(外键\) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| _**profession**_ | prof\_id\(主键\) | profession |  |  |  |

```
//内联结语句，将profession表中的profession列根据prof_id联结进入my_contacts表
SELECT mc.name, mc.phone, p.profession
FROM my_contacts mc
    INNER JOIN
    profession p
ON mc.prod_id = p.prod_id;        /*根据这个条件来联结表,也可以根据条件，把=改成<>。*/


//自然联结，根据两张表中名字相同的列来内联结
SELECT mc.name, mc.phone, p.profession
FROM my_contacts mc
    NATURAL JOIN
    profession p;
```

---

## \*子查询

* #### 子查询都是单一SELECT语句
* #### 会出现在：1.SELECT子句中。2.列选择中。3.FROM子句中。4.HAVING子句中。
* #### 子查询能与INSERT, DELETE, UPDATE, SELECT一起用。

| _**my\_contacts**_ | contact\_id\(主\) | name | phone | prod\_id\(外键\) | zip\_code\(外\) |  |
| :--- | :--- | :--- | :--- | :--- | :---: | :---: |
|  |  |  |  |  |  |  |
| _**job\_current**_ | contact\_id\(主+外\) | title | salary | start\_date |  |  |
| _**job\_desired**_ | contact\_id\(主+外\) | title | salary\_low | salary\_high | available | years\_exp |
|  |  |  |  |  |  |  |
| _**contact\_interest**_ | contact\_id\(外\) | interest\_id\(外\) |  |  |  |  |
| _**interests**_ | interest\_id\(主） | interest |  |  |  |  |
|  |  |  |  |  |  |  |
| _**contact\_seek**_ | contact\_id\(外\) | seeking\_id\(外\) |  |  |  |  |
| _**seeking**_ | seeking\_id\(主\) | seeking |  |  |  |  |
|  |  |  |  |  |  |  |
| _**profession**_ | prof\_id\(主\) | professioin |  |  |  |  |
| _**zip\_code**_ | zip\_code\(主\) | city | province |  |  |  |
|  |  |  |  |  |  |  |
| _**job\_listings**_ | job\_id\(主\) | title | salary | zip | description |  |

```
//子查询 ==>  查询符合job_listings表中要求的人的信息
SELECT mc.name, mc.phone, jc.title
FROM job_current jc
    NAUTRAL JOIN 
    my_contacts mc
WHERE jc.title IN 
(SELECT title FROM job_listings
GROUP BY title
ORDER BY title
);

//子查询 ==>  选出薪水最高的一个人
SELECT mc.name, jc.salary
FROM my_contacts mc 
    NATURAL JOIN
    job_current jc
WHERE jc.salary = 
(SELECT MAX(jc.salary)
FROM job_current jc);

//子查询 ==>  选出每一行的名字，手机，城市
SELECT mc.name, mc.phone, 
(SELECT zc.city
FROM zip_code zc
WHERE mc.zip_code = zc.zip_code) AS state
FROM my_contacts mc;
```



